---
title: "Excercise_1"
output:
  pdf_document:
    latex_engine: xelatex

date: "2025-01-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Step 0: Load Required Libraries
```{r}
library(restriktor)  # For constrained regression
library(ggplot2)     # For data visualization
library(rstudioapi)  # For data upload
```

# Step 1: Load the Dataset

```{r}
file_path <- "C:\\Users\\tufma\\Desktop\\!ASML\\Task\\Dataset_ozone (1).txt"
ozone <- read.csv2(file_path, sep = ";", dec = ",")

```


# Step 2: Summarize the Dataset
```{r}
# Basic structure
str(ozone)

# Summary statistics
summary(ozone)

# Check variables
# Note: 'vent' and 'pluie' are categorical, others are numerical
# 'obs' is an identifier and should be excluded
```

# Step 3: Check for Missing Values
```{r}
# Count missing values per column
colSums(is.na(ozone))

# If missing values exist, handle them (remove rows):
# ozone_clean <- na.omit(ozone)
```

# Step 4: Clean the Dataset
```{r}

# Remove identifier column 'obs' and categorical variables
ozone_clean <- ozone[, !(names(ozone) %in% c("obs", "vent", "pluie"))]
```

# Step 5: Fit Unconstrained Model
```{r}
# Unconstrained Model (All numerical predictors)
model_unconstrained <- lm(maxO3 ~ ., data = ozone_clean)
summary(model_unconstrained)
```

# Step 6: Fit Constrained Model
```{r}
# Constrained Model (βT9 + βT12 + βT15 = 0)
model_constrained <- restriktor(model_unconstrained,
                                constraints = "T9 + T12 + T15 == 0")
summary(model_constrained)
```
# Step 7: Compare coefficients
```{r}

# Compare coefficients
coef_comparison <- data.frame(
  Unconstrained = coef(model_unconstrained),
  Constrained = coef(model_constrained)
)
print(coef_comparison)
```


# Step 8: Compare models
```{r}

# Hypothesis Testing: Model Comparison Framework

# H₀: Imposing the constraint βT9 + βT12 + βT15 = 0 
#     does NOT significantly worsen model fit
#     (Constrained model performs equally well)

# H₁: The constraint βT9 + βT12 + βT15 = 0 
#     significantly worsens model fit
#     (Unconstrained model performs better)


# Compute Residual Sum of Squares (RSS)
RSS_unconstrained <- sum(resid(model_unconstrained)^2)  # Better fitting model
RSS_constrained <- sum(resid(model_constrained)^2)      # Restricted model

# Calculate degrees of freedom
n <- nrow(ozone_clean)        # Total observations
p <- length(coef(model_unconstrained)) - 1  # Predictors (excluding intercept)
q <- 1                                # Number of constraints applied

# F-Statistic: Measures relative improvement in fit
F_stat <- ((RSS_constrained - RSS_unconstrained)/q)/(RSS_unconstrained/(n-p-1))

# P-value: Probability of observing this F-statistic if H₀ is true
p_value <- pf(F_stat, df1 = q, df2 = n-p-1, lower.tail = FALSE)

# Interpret results
cat("Model Comparison Results:\n")
cat("---------------------------------\n")
cat("Unconstrained Model RSS:", round(RSS_unconstrained, 2), "\n")
cat("Constrained Model RSS:   ", round(RSS_constrained, 2), "\n")
cat("F-statistic (Improvement Ratio):", round(F_stat, 3), "\n")
cat("p-value:", format.pval(p_value, eps = 0.001), "\n\n")

if(p_value < 0.05) {
  cat("Conclusion: Reject H₀ - Constraining coefficients significantly worsens model fit (p =", 
      format.pval(p_value, digits = 3), ")")
} else {
  cat("Conclusion: Fail to reject H₀ - No evidence that constraint worsens fit (p =", 
      format.pval(p_value, digits = 3), ")")
}
```





